generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  user_id       Int     @id @default(autoincrement())
  user_email    String  @unique
  user_name     String
  gender        String
  avatar        String?
  points_gained Int?
  password      String

  registeredAt DateTime @default(now())
  updatedAt    DateTime @default(now()) @updatedAt

  blogs            Blog[]
  likes            Like[]
  sentRequests     FriendRequest[] @relation("sentRequests") // Friend requests sent by this user
  receivedRequests FriendRequest[] @relation("receivedRequests") // Friend requests received by this user
}

model Blog {
  blog_id          Int      @id @default(autoincrement())
  blog_title       String?
  blog_description String?
  blog_image       String
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  category_id Int
  category    Category @relation(fields: [category_id], references: [category_id])

  user_id Int
  user    User   @relation(fields: [user_id], references: [user_id])
  likes   Like[]
}

model Category {
  category_id   Int    @id @default(autoincrement())
  category_name String

  blogs Blog[]
}

model Like {
  like_id Int @id @default(autoincrement())

  liked_by  Int // User who liked the blog
  user      User     @relation(fields: [liked_by], references: [user_id])
  blog_id   Int // Blog that was liked
  blog      Blog     @relation(fields: [blog_id], references: [blog_id])
  createdAt DateTime @default(now()) // Timestamp for when the like was made
}

model FriendRequest {
  request_id     Int           @id @default(autoincrement())
  sender_id      Int
  receiver_id    Int
  request_status RequestStatus @default(PENDING)
  createdAt      DateTime      @default(now())

  sender   User @relation(fields: [sender_id], references: [user_id], name: "sentRequests")
  receiver User @relation(fields: [receiver_id], references: [user_id], name: "receivedRequests")
}

enum RequestStatus {
  PENDING
  ACCEPTED
  REJECTED
}
